<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8"/>
    <title>태그 관리</title>
    <style>
        body { font-family:sans-serif; margin:2rem; }
        ul { list-style:none; padding:0; }
        li { margin-bottom:1rem; }
        .actions { font-size:0.9rem; margin-left:1rem; }
        input, button, a { margin-right:0.5rem; }
    </style>
</head>
<body>

<h1>태그 목록</h1>

<!-- 새 태그 생성 -->
<form th:action="@{/tags}" method="post">
    <input type="text" name="name" placeholder="새 태그 이름" required/>
    <button type="submit">생성</button>
</form>
<hr/>

<ul>
    <li th:each="tag : ${tags}">
        <!-- 수정 모드 -->
        <div th:if="${editTagId} == ${tag.id}">
            <form th:action="@{/tags/{id}(id=${tag.id})}" method="post" style="display:inline">
                <input type="text" name="name" th:value="${tag.name}" required/>
                <button type="submit">저장</button>
            </form>
            <a th:href="@{/tags}">취소</a>
        </div>

        <!-- 일반 모드 -->
        <div th:unless="${editTagId} == ${tag.id}">
            <!-- 태그명 클릭 시 selectedTagId만 넘김 -->
            <a th:href="@{/tags(selectedTagId=${tag.id})}"
               th:text="${tag.name}">태그명</a>
            <span class="actions">
        <a th:href="@{/tags(editTagId=${tag.id}, selectedTagId=${selectedTagId})}">수정</a>
        <form th:action="@{/tags/{id}(id=${tag.id})}"
              method="post" style="display:inline"
              onsubmit="return confirm('정말 삭제하시겠습니까?');">
          <input type="hidden" name="_method" value="delete"/>
          <button type="submit">삭제</button>
        </form>
                <!-- “일기 보기” 링크 제거 -->
      </span>
        </div>
    </li>
</ul>
<hr/>

<!-- 선택된 태그의 일기들 -->
<div th:if="${selectedTag != null}">
    <h2 th:text="'#' + ${selectedTag.name} + ' 태그 일기 목록'"></h2>
    <ul>
        <li th:each="e : ${entries}">
            <h3 th:text="${e.title}">제목</h3>
            <p th:text="${e.content}">본문</p>
        </li>
        <li th:if="${#lists.isEmpty(entries)}">
            해당 태그가 달린 일기가 없습니다.
        </li>
    </ul>
</div>

</body>
</html>
